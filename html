<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MVP Genie</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
      body {
        font-family: 'Inter', sans-serif;
      }
      .animate-fade-in {
        animation: fadeIn 0.5s ease-in-out;
      }
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
      }
    </style>
  <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@18.2.0",
    "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.25.0"
  }
}
</script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
  <body class="bg-gray-900 text-white">
    <div id="root"></div>
    <script type="text/babel" data-type="module">
// --- MODULE IMPORTS ---
import { GoogleGenAI, Type } from "@google/genai";
import React, { useState, useCallback, useEffect } from 'react';
import ReactDOM from 'react-dom/client';

// --- SERVICES (geminiService.ts) ---
const API_KEY = process.env.API_KEY;

if (!API_KEY) {
  const rootElement = document.getElementById('root');
  if (rootElement) {
      rootElement.innerHTML = `
        <div style="font-family: 'Inter', sans-serif; text-align: center; padding: 2rem; color: #f3f4f6;">
            <h1 style="font-size: 1.5rem; font-weight: bold;">Configuration Error</h1>
            <p style="color: #d1d5db;">The AI features are disabled because the API key is not configured.</p>
        </div>
      `;
  }
  console.error("API_KEY environment variable not set");
}

const ai = new GoogleGenAI({ apiKey: API_KEY });

const mvpPlanSchema = {
  type: Type.OBJECT,
  properties: {
    projectName: {
      type: Type.STRING,
      description: "A catchy and relevant name for the project."
    },
    summary: {
      type: Type.STRING,
      description: "A brief, one-paragraph summary of the business idea and the problem it solves."
    },
    coreFeatures: {
      type: Type.ARRAY,
      description: "A list of 3-5 essential features for the Minimum Viable Product.",
      items: { type: Type.STRING }
    },
    userPersonas: {
      type: Type.ARRAY,
      description: "A list of 2-3 target user personas, with a brief description for each.",
      items: { type: Type.STRING }
    },
    techStack: {
      type: Type.OBJECT,
      description: "A suggested technology stack for the MVP.",
      properties: {
        frontend: { type: Type.STRING, description: "e.g., React, Vue, Svelte" },
        backend: { type: Type.STRING, description: "e.g., Node.js (Express), Python (Django), Go" },
        database: { type: Type.STRING, description: "e.g., PostgreSQL, MongoDB, Firebase" }
      },
      required: ["frontend", "backend", "database"]
    },
    userStories: {
      type: Type.ARRAY,
      description: "A list of key user stories in the format 'As a [persona], I want [goal] so that [benefit]'.",
      items: { type: Type.STRING }
    },
    monetizationStrategies: {
      type: Type.ARRAY,
      description: "A list of potential monetization strategies for the business.",
      items: { type: Type.STRING }
    },
    successMetrics: {
      type: Type.ARRAY,
      description: "A list of key performance indicators (KPIs) to measure the success of the MVP.",
      items: { type: Type.STRING }
    }
  },
  required: ["projectName", "summary", "coreFeatures", "userPersonas", "techStack", "userStories", "monetizationStrategies", "successMetrics"]
};

const landingPageSchema = {
    type: Type.OBJECT,
    properties: {
        headline: { type: Type.STRING, description: "A powerful, attention-grabbing headline for the landing page hero section." },
        subheading: { type: Type.STRING, description: "A concise, benefit-driven subheading that elaborates on the headline." },
        ctaButton: { type: Type.STRING, description: "Compelling text for the main call-to-action button, e.g., 'Get Early Access'." },
        features: {
            type: Type.ARRAY,
            description: "A list of exactly 3 key features or benefits to highlight on the landing page.",
            items: {
                type: Type.OBJECT,
                properties: {
                    title: { type: Type.STRING, description: "The title of the feature." },
                    description: { type: Type.STRING, description: "A short, engaging description of the feature's benefit to the user." },
                    icon: { 
                        type: Type.STRING, 
                        description: "A relevant icon name from the following list: 'zap', 'shield-check', 'users', 'globe', 'trending-up', 'star'.",
                        enum: ['zap', 'shield-check', 'users', 'globe', 'trending-up', 'star']
                    }
                },
                required: ["title", "description", "icon"]
            }
        }
    },
    required: ["headline", "subheading", "ctaButton", "features"]
};


const generateMVPPlan = async (idea) => {
  const prompt = `
    Analyze the following business idea and generate a comprehensive MVP (Minimum Viable Product) plan. 
    The plan should be clear, concise, and actionable for a working professional looking to start this project.
    
    Business Idea: "${idea}"

    Provide a detailed breakdown covering all the fields in the requested JSON schema.
  `;

  try {
    const response = await ai.models.generateContent({
      model: "gemini-2.5-flash",
      contents: prompt,
      config: {
        responseMimeType: "application/json",
        responseSchema: mvpPlanSchema,
        temperature: 0.7,
      },
    });

    const jsonText = response.text.trim();
    const parsedPlan = JSON.parse(jsonText);
    return parsedPlan;

  } catch (error) {
    console.error("Error generating content from Gemini:", error);
    throw new Error("Failed to generate MVP plan from Gemini API.");
  }
};

const generateLandingPageContent = async (idea, mvpPlan) => {
    const prompt = `
      Based on the following business idea and its corresponding MVP plan, generate compelling marketing copy for a promotional landing page.
      The tone should be exciting, professional, and persuasive, aimed at attracting early users.

      Business Idea: "${idea}"

      MVP Plan:
      - Project Name: ${mvpPlan.projectName}
      - Summary: ${mvpPlan.summary}
      - Core Features: ${mvpPlan.coreFeatures.join(', ')}
      - Target Audience: ${mvpPlan.userPersonas.join(', ')}

      Generate the content according to the provided JSON schema. Ensure the features you create are directly inspired by the MVP's core features.
    `;

    try {
        const response = await ai.models.generateContent({
            model: "gemini-2.5-flash",
            contents: prompt,
            config: {
                responseMimeType: "application/json",
                responseSchema: landingPageSchema,
                temperature: 0.8,
            },
        });
        
        const jsonText = response.text.trim();
        const parsedContent = JSON.parse(jsonText);
        return parsedContent;

    } catch (error) {
        console.error("Error generating landing page content from Gemini:", error);
        throw new Error("Failed to generate landing page content from Gemini API.");
    }
};

// --- HOOKS (useUsageTracker.ts) ---
const useUsageTracker = () => {
  const USAGE_LIMIT = 5;
  const STORAGE_KEY = 'mvp-generator-usage';

  const getUsageCount = () => {
    try {
      const storedUsage = localStorage.getItem(STORAGE_KEY);
      if (storedUsage) {
        const { count, date } = JSON.parse(storedUsage);
        const today = new Date().toDateString();
        if (date !== today) {
          localStorage.removeItem(STORAGE_KEY);
          return 0;
        }
        return count;
      }
    } catch (error) {
      console.error("Failed to read usage from local storage", error);
      localStorage.removeItem(STORAGE_KEY);
    }
    return 0;
  };

  const [usageCount, setUsageCount] = useState(0);

  useEffect(() => {
    setUsageCount(getUsageCount());
  }, []);

  const isLimitReached = usageCount >= USAGE_LIMIT;

  const incrementUsage = useCallback(() => {
    const currentCount = getUsageCount();
    const newCount = currentCount + 1;
    const today = new Date().toDateString();
    try {
      const newUsage = { count: newCount, date: today };
      localStorage.setItem(STORAGE_KEY, JSON.stringify(newUsage));
      setUsageCount(newCount);
    } catch (error) {
      console.error("Failed to write usage to local storage", error);
    }
  }, []);

  return { usageCount, incrementUsage, isLimitReached, USAGE_LIMIT };
};

// --- HOOKS (useHistory.ts) ---
const useHistory = () => {
  const HISTORY_STORAGE_KEY = 'mvp-generator-history';
  const [history, setHistory] = useState([]);

  useEffect(() => {
    try {
      const storedHistory = localStorage.getItem(HISTORY_STORAGE_KEY);
      if (storedHistory) {
        setHistory(JSON.parse(storedHistory));
      }
    } catch (error) {
      console.error("Failed to load history from local storage", error);
      localStorage.removeItem(HISTORY_STORAGE_KEY);
    }
  }, []);

  const addHistoryEntry = useCallback((mvpPlan, landingPageContent) => {
    const newEntry = {
      id: crypto.randomUUID(),
      mvpPlan,
      landingPageContent,
      createdAt: new Date().toISOString(),
    };

    setHistory(prevHistory => {
      const updatedHistory = [newEntry, ...prevHistory];
      try {
        localStorage.setItem(HISTORY_STORAGE_KEY, JSON.stringify(updatedHistory));
      } catch (error) {
        console.error("Failed to save history to local storage", error);
      }
      return updatedHistory;
    });
  }, []);
  
  const clearHistory = useCallback(() => {
    setHistory([]);
    try {
      localStorage.removeItem(HISTORY_STORAGE_KEY);
    } catch (error) {
        console.error("Failed to clear history from local storage", error);
    }
  }, []);

  return { history, addHistoryEntry, clearHistory };
};

// --- COMPONENTS (Icons.tsx) ---
const BriefcaseIcon = (props) => (
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
    <rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect>
    <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path>
  </svg>
);
const CheckCircleIcon = (props) => (
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
    <polyline points="22 4 12 14.01 9 11.01"></polyline>
  </svg>
);
const ClipboardCopyIcon = (props) => (
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
  </svg>
);
const CurrencyDollarIcon = (props) => (
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
    <line x1="12" y1="1" x2="12" y2="23"></line>
    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
  </svg>
);
const LightBulbIcon = (props) => (
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
    <path d="M9 18h6"></path>
    <path d="M10 22h4"></path>
    <path d="M12 2a7 7 0 0 0-7 7c0 3.04 1.63 5.44 4 6.57V22h6v-6.43c2.37-1.13 4-3.53 4-6.57a7 7 0 0 0-7-7z"></path>
  </svg>
);
const TagIcon = (props) => (
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
    <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path>
    <line x1="7" y1="7" x2="7.01" y2="7"></line>
  </svg>
);
const UserGroupIcon = (props) => (
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
    <circle cx="9" cy="7" r="4"></circle>
    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
  </svg>
);
const UsersIcon = (props) => (
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
    <circle cx="9" cy="7" r="4"></circle>
    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
  </svg>
);
const CodeBracketIcon = (props) => (
    <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" {...props}>
      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
    </svg>
);
const GlobeAltIcon = (props) => (
    <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" {...props}>
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m0 0a9 9 0 019-9m-9 9a9 9 0 009 9" />
    </svg>
);
const ZapIcon = (props) => (
    <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" {...props}>
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 10V3L4 14h7v7l9-11h-7z" />
    </svg>
);
const ShieldCheckIcon = (props) => (
    <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" {...props}>
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 20.417l5.611-1.377a12.02 12.02 0 001.922 2.368A12.02 12.02 0 0012 22a12.02 12.02 0 006.467-3.04l5.611 1.377a12.02 12.02 0 00-2.367-11.455z" />
    </svg>
);
const StarIcon = (props) => (
    <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" {...props}>
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.196-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.783-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
    </svg>
);
const TrendingUpIcon = (props) => (
    <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" {...props}>
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
    </svg>
);
const LockClosedIcon = (props) => (
    <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" {...props}>
      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
    </svg>
);
const ChevronDownIcon = (props) => (
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-6 h-6" {...props}>
      <path strokeLinecap="round" strokeLinejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
    </svg>
);
const TrashIcon = (props) => (
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-6 h-6" {...props}>
      <path strokeLinecap="round" strokeLinejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.124-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.077-2.09.921-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />
    </svg>
);

// --- COMPONENTS (ResultCard.tsx) ---
const ResultCard = ({ title, icon, children }) => {
  return (
    <div className="bg-gray-800/50 border border-gray-700 rounded-xl p-6 shadow-lg h-full">
      <div className="flex items-center gap-3 mb-4">
        <span className="text-purple-400">{icon}</span>
        <h3 className="text-xl font-bold text-gray-100">{title}</h3>
      </div>
      <div>{children}</div>
    </div>
  );
};

// --- COMPONENTS (Loader.tsx) ---
const Loader = ({ message = "Brewing up your MVP plan..." }) => {
  return (
    <div className="flex flex-col items-center justify-center space-y-4 p-8">
       <div className="w-16 h-16 border-4 border-purple-400 border-t-transparent rounded-full animate-spin"></div>
       <p className="text-lg text-gray-300">{message}</p>
    </div>
  );
};

// --- COMPONENTS (MVPResult.tsx) ---
const MVPResult = ({ plan }) => {
    const [copied, setCopied] = useState(false);

    const planToText = () => {
        let text = `MVP Plan for: ${plan.projectName}\n\n`;
        text += `Summary:\n${plan.summary}\n\n`;
        text += `Core Features:\n${plan.coreFeatures.map(f => `- ${f}`).join('\n')}\n\n`;
        text += `User Personas:\n${plan.userPersonas.map(p => `- ${p}`).join('\n')}\n\n`;
        text += `Tech Stack:\n- Frontend: ${plan.techStack.frontend}\n- Backend: ${plan.techStack.backend}\n- Database: ${plan.techStack.database}\n\n`;
        text += `User Stories:\n${plan.userStories.map(s => `- ${s}`).join('\n')}\n\n`;
        text += `Monetization Strategies:\n${plan.monetizationStrategies.map(s => `- ${s}`).join('\n')}\n\n`;
        text += `Success Metrics:\n${plan.successMetrics.map(s => `- ${s}`).join('\n')}`;
        return text;
    };

    const handleCopy = () => {
        navigator.clipboard.writeText(planToText());
        setCopied(true);
        setTimeout(() => setCopied(false), 2000);
    };

  return (
    <div className="space-y-6">
      <div className="relative text-center p-6 bg-gray-800/50 border border-gray-700 rounded-xl">
          <h2 className="text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-indigo-500">{plan.projectName}</h2>
          <p className="mt-2 text-gray-300">{plan.summary}</p>
          <button
            onClick={handleCopy}
            className="absolute top-4 right-4 bg-gray-700 hover:bg-gray-600 text-gray-300 font-medium py-2 px-3 rounded-lg flex items-center gap-2 transition-colors duration-200"
            aria-label="Copy plan to clipboard"
          >
            {copied ? <CheckCircleIcon className="w-5 h-5 text-green-400" /> : <ClipboardCopyIcon className="w-5 h-5" />}
            <span className="hidden sm:inline">{copied ? 'Copied!' : 'Copy'}</span>
          </button>
      </div>

      <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
        <ResultCard title="Core Features" icon={<LightBulbIcon />}>
          <ul className="list-disc list-inside space-y-2 text-gray-300">
            {plan.coreFeatures.map((feature, index) => <li key={index}>{feature}</li>)}
          </ul>
        </ResultCard>

        <ResultCard title="User Personas" icon={<UsersIcon />}>
          <ul className="list-disc list-inside space-y-2 text-gray-300">
            {plan.userPersonas.map((persona, index) => <li key={index}>{persona}</li>)}
          </ul>
        </ResultCard>

        <ResultCard title="Tech Stack Suggestion" icon={<BriefcaseIcon />}>
          <div className="space-y-2 text-gray-300">
            <p><strong>Frontend:</strong> {plan.techStack.frontend}</p>
            <p><strong>Backend:</strong> {plan.techStack.backend}</p>
            <p><strong>Database:</strong> {plan.techStack.database}</p>
          </div>
        </ResultCard>

        <ResultCard title="User Stories" icon={<UserGroupIcon />}>
            <ul className="list-disc list-inside space-y-2 text-gray-300">
                {plan.userStories.map((story, index) => <li key={index}>{story}</li>)}
            </ul>
        </ResultCard>

        <ResultCard title="Monetization Strategies" icon={<CurrencyDollarIcon />}>
            <ul className="list-disc list-inside space-y-2 text-gray-300">
                {plan.monetizationStrategies.map((strategy, index) => <li key={index}>{strategy}</li>)}
            </ul>
        </ResultCard>

        <ResultCard title="Success Metrics" icon={<TagIcon />}>
            <ul className="list-disc list-inside space-y-2 text-gray-300">
                {plan.successMetrics.map((metric, index) => <li key={index}>{metric}</li>)}
            </ul>
        </ResultCard>
      </div>
    </div>
  );
};

// --- COMPONENTS (LandingPageResult.tsx) ---
const LandingPageResult = ({ content, projectName }) => {
    const [copied, setCopied] = useState(false);

    const featureIcons = {
        'zap': <ZapIcon className="w-8 h-8 text-yellow-400" />,
        'shield-check': <ShieldCheckIcon className="w-8 h-8 text-blue-400" />,
        'users': <UsersIcon className="w-8 h-8 text-teal-400" />,
        'globe': <GlobeAltIcon className="w-8 h-8 text-green-400" />,
        'trending-up': <TrendingUpIcon className="w-8 h-8 text-rose-400" />,
        'star': <StarIcon className="w-8 h-8 text-amber-400" />
    };
    
    const generateHtml = () => {
        const featuresHtml = content.features.map(feature => `
            <div class="bg-gray-800 p-6 rounded-lg text-center">
                <h3 class="text-xl font-bold mb-2">${feature.title}</h3>
                <p class="text-gray-400">${feature.description}</p>
            </div>
        `).join('');

        return `
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${projectName}</title>
    <script src="https://cdn.tailwindcss.com"><\/script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .gradient-text { background: linear-gradient(to right, #a78bfa, #6366f1); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    </style>
</head>
<body class="bg-gray-900 text-white">
    <div class="max-w-4xl mx-auto p-8">
        <header class="text-center py-16">
            <h1 class="text-5xl md:text-6xl font-extrabold mb-4">${content.headline}</h1>
            <p class="text-xl text-gray-300 mb-8">${content.subheading}</p>
            <a href="#" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-8 rounded-full text-lg transition-transform transform hover:scale-105">${content.ctaButton}</a>
        </header>
        <main>
            <section class="py-16">
                <div class="grid md:grid-cols-3 gap-8">
                    ${featuresHtml}
                </div>
            </section>
        </main>
        <footer class="text-center py-8 border-t border-gray-800">
            <p class="text-gray-500">&copy; ${new Date().getFullYear()} ${projectName}. All rights reserved.</p>
        </footer>
    </div>
</body>
</html>
        `;
    };

    const handleCopyHtml = () => {
        navigator.clipboard.writeText(generateHtml());
        setCopied(true);
        setTimeout(() => setCopied(false), 2000);
    };

  return (
    <div className="space-y-6">
        <div className="flex items-center gap-3">
            <GlobeAltIcon className="w-6 h-6 text-green-400" />
            <h2 className="text-2xl font-bold">Landing Page Preview</h2>
        </div>
      
      <div className="bg-gray-800/50 border border-gray-700 rounded-xl shadow-lg relative">
        <div className="p-6">
            {/* Header / Hero */}
            <div className="text-center py-12">
                <h1 className="text-4xl md:text-5xl font-extrabold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-indigo-500">{content.headline}</h1>
                <p className="text-lg text-gray-300 mb-6">{content.subheading}</p>
                <button className="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg transition-transform transform hover:scale-105">{content.ctaButton}</button>
            </div>
            
            {/* Features */}
            <div className="py-12">
                 <div className="grid md:grid-cols-3 gap-6">
                    {content.features.map((feature, index) => (
                        <div key={index} className="bg-gray-800 p-6 rounded-lg text-center flex flex-col items-center">
                             <div className="mb-4">{featureIcons[feature.icon] || featureIcons['star']}</div>
                            <h3 className="text-xl font-bold mb-2 text-gray-100">{feature.title}</h3>
                            <p className="text-gray-400">{feature.description}</p>
                        </div>
                    ))}
                </div>
            </div>

             {/* Footer */}
            <div className="text-center py-6 border-t border-gray-700">
                 <p className="text-gray-500">&copy; {new Date().getFullYear()} {projectName}. All rights reserved.</p>
            </div>
        </div>

        <button
            onClick={handleCopyHtml}
            className="absolute top-4 right-4 bg-gray-700 hover:bg-gray-600 text-gray-300 font-medium py-2 px-3 rounded-lg flex items-center gap-2 transition-colors duration-200"
            aria-label="Copy HTML"
          >
            {copied ? <CheckCircleIcon className="w-5 h-5 text-green-400" /> : <CodeBracketIcon className="w-5 h-5" />}
            <span className="hidden sm:inline">{copied ? 'Copied!' : 'Copy HTML'}</span>
          </button>
      </div>
    </div>
  );
};


// --- COMPONENTS (HistoryItem.tsx) ---
const HistoryItem = ({ entry }) => {
  const [isOpen, setIsOpen] = useState(false);

  const formattedDate = new Date(entry.createdAt).toLocaleString(undefined, {
    dateStyle: 'medium',
    timeStyle: 'short',
  });

  return (
    <div className="bg-gray-800/50 border border-gray-700 rounded-xl overflow-hidden">
      <button
        onClick={() => setIsOpen(!isOpen)}
        className="w-full flex justify-between items-center p-4 text-left hover:bg-gray-700/50 transition-colors"
        aria-expanded={isOpen}
      >
        <div className="flex-1 mr-4">
            <h3 className="font-bold text-lg text-white">{entry.mvpPlan.projectName}</h3>
            <p className="text-sm text-gray-400">{formattedDate}</p>
        </div>
        <ChevronDownIcon className={`w-5 h-5 text-gray-400 transition-transform duration-300 ${isOpen ? 'rotate-180' : ''}`} />
      </button>
      {isOpen && (
        <div className="p-4 md:p-6 border-t border-gray-700 animate-fade-in">
          <div className="space-y-8 md:space-y-12">
            <MVPResult plan={entry.mvpPlan} />
            <LandingPageResult content={entry.landingPageContent} projectName={entry.mvpPlan.projectName} />
          </div>
        </div>
      )}
    </div>
  );
};

// --- COMPONENTS (HistorySection.tsx) ---
const HistorySection = ({ history, onClear }) => {
  return (
    <div className="mt-12 md:mt-16">
      <div className="flex justify-between items-center mb-6">
        <h2 className="text-3xl font-bold text-gray-200">Your Past Plans</h2>
        {history.length > 0 && (
            <button 
                onClick={onClear} 
                className="flex items-center gap-2 text-sm text-gray-400 hover:text-red-400 transition-colors"
                aria-label="Clear all history"
            >
                <TrashIcon className="w-4 h-4" />
                Clear All
            </button>
        )}
      </div>
      <div className="space-y-4">
        {history.map(entry => (
          <HistoryItem key={entry.id} entry={entry} />
        ))}
      </div>
    </div>
  );
};

// --- COMPONENTS (Paywall.tsx) ---
const Paywall = ({ limit }) => {
  return (
    <div className="bg-gray-800/50 border border-gray-700 rounded-xl p-6 sm:p-8 text-center animate-fade-in shadow-2xl shadow-purple-900/20">
      <div className="flex justify-center mb-4">
        <LockClosedIcon className="w-12 h-12 text-yellow-400" />
      </div>
      <h2 className="text-2xl font-bold text-white mb-2">You've reached your daily limit</h2>
      <p className="text-gray-300">
        You've generated {limit} MVP plans for today. Please come back tomorrow to generate more!
      </p>
      <p className="text-sm text-gray-400 mt-4">
        This is a demo project to showcase AI capabilities.
      </p>
    </div>
  );
};

// --- COMPONENTS (Hero.tsx) ---
const Hero = ({ onGenerate, isLoading }) => {
  const [idea, setIdea] = useState('');

  const handleSubmit = (e) => {
    e.preventDefault();
    onGenerate(idea);
  };

  return (
    <div className="bg-gray-800/50 border border-gray-700 rounded-xl p-6 sm:p-8 shadow-2xl shadow-purple-900/20">
      <form onSubmit={handleSubmit}>
        <label htmlFor="business-idea" className="block text-lg font-semibold mb-3 text-gray-300">
          Enter your business idea
        </label>
        <textarea
          id="business-idea"
          rows={4}
          className="w-full bg-gray-900 border border-gray-600 rounded-lg p-4 focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-shadow duration-200 placeholder-gray-500 text-white"
          placeholder="e.g., A subscription box service for artisanal coffee from around the world."
          value={idea}
          onChange={(e) => setIdea(e.target.value)}
          disabled={isLoading}
        />
        <button
          type="submit"
          disabled={isLoading || !idea.trim()}
          className="mt-4 w-full flex items-center justify-center gap-2 bg-gradient-to-r from-purple-600 to-indigo-600 text-white font-bold py-3 px-6 rounded-lg hover:from-purple-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-indigo-500 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105 disabled:scale-100"
        >
          {isLoading ? (
            <>
              <svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
              </svg>
              Generating...
            </>
          ) : (
            'Generate MVP Plan'
          )}
        </button>
      </form>
    </div>
  );
};


// --- MAIN APP COMPONENT (App.tsx) ---
const App = () => {
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState(null);
  const { isLimitReached, incrementUsage, USAGE_LIMIT } = useUsageTracker();
  const { history, addHistoryEntry, clearHistory } = useHistory();

  const handleGenerate = useCallback(async (submittedIdea) => {
    if (isLoading || isLimitReached || !API_KEY) return;

    setIsLoading(true);
    setError(null);

    try {
      const plan = await generateMVPPlan(submittedIdea);
      const content = await generateLandingPageContent(submittedIdea, plan);
      
      addHistoryEntry(plan, content);
      incrementUsage();
    } catch (err) {
      setError("Something went wrong while generating the plan. Please try again.");
      console.error(err);
    } finally {
      setIsLoading(false);
    }
  }, [isLoading, isLimitReached, incrementUsage, addHistoryEntry]);

  const latestResult = history.length > 0 ? history[0] : null;

  return (
    <div className="bg-gray-900 min-h-screen text-white font-sans">
      <div className="container mx-auto px-4 py-8 sm:py-12 md:py-16">
        <header className="text-center mb-8 sm:mb-12">
          <h1 className="text-4xl sm:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-indigo-500">
            MVP Launchpad
          </h1>
          <p className="mt-4 text-lg sm:text-xl text-gray-400 max-w-2xl mx-auto">
            Turn your business idea into a comprehensive MVP plan and a stunning landing page with the power of AI.
          </p>
        </header>

        <main className="max-w-4xl mx-auto">
          <div className="space-y-8">
            {isLimitReached ? (
              <Paywall limit={USAGE_LIMIT} />
            ) : (
              <Hero onGenerate={handleGenerate} isLoading={isLoading} />
            )}

            {error && (
              <div className="bg-red-900/50 border border-red-700 text-red-300 px-4 py-3 rounded-lg text-center">
                <p>{error}</p>
              </div>
            )}

            {isLoading && <Loader message="Brewing up your masterpiece..." />}

            {!isLoading && latestResult && (
              <div className="space-y-8 md:space-y-12 animate-fade-in">
                  <MVPResult plan={latestResult.mvpPlan} />
                  <LandingPageResult content={latestResult.landingPageContent} projectName={latestResult.mvpPlan.projectName} />
              </div>
            )}
          </div>

          {!isLoading && history.length > 0 && (
            <HistorySection history={history} onClear={clearHistory} />
          )}
        </main>
        
        <footer className="text-center mt-12 text-gray-500">
          <p>Powered by Google Gemini</p>
        </footer>
      </div>
    </div>
  );
};


// --- RENDER APP (index.tsx) ---
const rootElement = document.getElementById('root');
if (!rootElement) {
  throw new Error("Could not find root element to mount to");
}

const root = ReactDOM.createRoot(rootElement);
root.render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);

    </script>
  </body>
</html>
